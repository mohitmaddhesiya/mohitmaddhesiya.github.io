!function(t,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports,require("d3"),require("@angular/core")):"function"==typeof define&&define.amd?define("ng6-o2-chart",["exports","d3","@angular/core"],a):a(t["ng6-o2-chart"]={},null,t.ng.core)}(this,function(exports,d3,core){"use strict";var LINE_CHART_TYPE_NAME="line",BAR_CHART_TYPE_NAME="bar",PIE_CHART_TYPE_NAME="pie",SCATTER_PLOT_CHART_TYPE_NAME="scatterPlot",HISTOGRAM_CHART_TYPE_NAME="histogram",STACK_BAR_CHART_TYPE_NAME="stackBar",GEO_MAP_CHART_TYPE_NAME="geoMap",GEO_ORTHOGRAPHIC_CHART_TYPE_NAME="geoOrthographic",TREE_MAP_CHART_TYPE_NAME="treeMap",PACK_LAYOUT_CHART_TYPE_NAME="packLayout",CHOROPLETH_CHART_TYPE_NAME="choropleth",TREE_CHART_TYPE_NAME="tree",SANKEY_CHART_TYPE_NAME="sankey",FORCE_CHART_TYPE_NAME="force",O2Common=function(){function t(t,a,e,r,n,i){this.svgContainer=t,this.configData=a,this.autoMaxX=e,this.autoMaxY=r,this.svgWidth=n,this.svgHeight=i}return Object.defineProperty(t.prototype,"axisClassName",{get:function(){return this.configData.className.axis},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineClassName",{get:function(){return this.configData.className.line},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXBorderLineClassName",{get:function(){return this.configData.className.axisXBorder},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxXValue",{get:function(){var t=this.autoMaxX;return this.configData.maxValue.auto||(t=this.configData.maxValue.x),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxYValue",{get:function(){var t=this.autoMaxY;return this.configData.maxValue.auto||(t=this.configData.maxValue.y),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphInitXPos",{get:function(){var t=this.configData.margin.left;return this.configData.legend.display&&"right"!==this.configData.legend.position&&(t=this.configData.margin.left+this.configData.legend.totalWidth),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphInitYPos",{get:function(){return this.configData.margin.top+this.configData.title.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphYScale",{get:function(){return this.graphHeight/this.maxYValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphXScale",{get:function(){return this.graphWidth/this.maxXValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphWidth",{get:function(){var t=this.configData.margin.left+this.configData.margin.right;return this.configData.legend.display&&(t+=this.configData.legend.totalWidth),this.svgWidth-t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphHeight",{get:function(){return this.svgHeight-this.configData.title.height-this.configData.margin.top-this.configData.margin.bottom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphCenterPos",{get:function(){var t=new Array,a=this.configData.margin.left+this.graphWidth/2,e=this.configData.margin.top+this.configData.title.height+this.graphHeight/2;return t.push(a),t.push(e),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphCenterTranslatePos",{get:function(){var t=this.configData.margin.left+this.graphWidth/2,a=this.configData.margin.top+this.configData.title.height+this.graphHeight/2;return"translate("+String(t)+", "+String(a)+")"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphInitTranslatePos",{get:function(){var t=this.graphInitXPos,a=this.graphInitYPos;return"translate("+String(t)+", "+String(a)+")"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXLabelInitXPos",{get:function(){return this.configData.margin.left+this.configData.axis.xLabel.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXLabelInitYPos",{get:function(){return this.svgHeight-this.configData.axis.xLabel.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisTranslatePos",{get:function(){var t=this.configData.margin.left,a=this.configData.margin.top+this.configData.title.height;return"translate("+String(t)+", "+String(a)+")"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXBorderLineWidth",{get:function(){return this.configData.axis.borderLineWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisYBorderHeight",{get:function(){var t=this.configData.margin.top+this.configData.margin.bottom+this.configData.title.height;return this.svgHeight-t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXBorderWidth",{get:function(){var t=this.configData.margin.left+this.configData.margin.right;return this.configData.legend.display&&(t+=this.configData.legend.totalWidth),this.svgWidth-t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisYOrient",{get:function(){return"left"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXOrient",{get:function(){return"bottom"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"axisXBorderTranslatePos",{get:function(){var t=String(this.svgHeight-this.configData.margin.bottom);return"translate("+this.configData.margin.left+", "+t+")"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerRadiusPercent",{get:function(){return this.configData.pie.innerRadius.percent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerRadiusTitle",{get:function(){return this.configData.pie.innerRadius.title},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerRadiusTitleTranslatePos",{get:function(){var t=this.configData.margin.left+this.graphWidth/2,a=this.configData.margin.top+this.configData.title.height+this.graphHeight/2+5;return"translate("+String(t)+", "+String(a)+")"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"legendInitXPos",{get:function(){var t=this.configData.margin.left+this.graphWidth+this.configData.legend.initXPos;return"right"!==this.configData.legend.position&&(t=this.configData.margin.left+this.configData.legend.initXPos),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"legendInitYPos",{get:function(){return this.configData.margin.top+this.configData.title.height+this.configData.legend.initYPos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridYStep",{get:function(){var t=10*Math.ceil(this.maxYValue/100);return 10*Math.ceil(t/10)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridXStep",{get:function(){var t=10*Math.ceil(this.maxXValue/100);return 10*Math.ceil(t/10)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titleInitXPos",{get:function(){return this.configData.margin.left+(this.graphWidth+this.configData.legend.totalWidth)/2+this.configData.title.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"titleInitYPos",{get:function(){return this.configData.margin.top+this.configData.title.height-this.configData.title.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultColorFunc",{get:function(){var t;return this.configData.color.auto&&(t="20"===this.configData.color.defaultColorNumber?d3.scaleOrdinal(d3.schemeCategory20):d3.scaleOrdinal(d3.schemeCategory10)),t},enumerable:!0,configurable:!0}),t}(),O2LegendData=function(t,a){this.title=t,this.color=a},O2ScatterPlotData=function(t,a,e){this.x=t,this.y=a,this.r=e},O2IdValueData=function(t,a){this.id=t,this.value=a},Ng6O2ChartComponent=function(){function Ng6O2ChartComponent(t){console.log("el:HTMLElement-------------------");var a=t.nativeElement;this.root=d3.select(a)}return Ng6O2ChartComponent.prototype.ngOnInit=function(){},Ng6O2ChartComponent.prototype.ngOnChanges=function(t){var a=parseInt(this.svgWidth,10),e=parseInt(this.svgHeight,10),r=this.graphData,n=this.configData,i=this.chartType,o=this.root.append("svg").attr("width",a).attr("height",e);switch(console.log(i),i){case LINE_CHART_TYPE_NAME:this.buildLine(o,n,r,a,e);break;case BAR_CHART_TYPE_NAME:this.buildBar(o,n,r,a,e);break;case PIE_CHART_TYPE_NAME:this.buildPie(o,n,r,a,e);break;case SCATTER_PLOT_CHART_TYPE_NAME:this.buildScatterPlot(o,n,r,a,e);break;case HISTOGRAM_CHART_TYPE_NAME:this.buildHistogram(o,n,r,a,e);break;case STACK_BAR_CHART_TYPE_NAME:this.buildStackBar(o,n,r,a,e);break;case GEO_MAP_CHART_TYPE_NAME:this.buildGeoMap(o,n,r,a,e);break;case GEO_ORTHOGRAPHIC_CHART_TYPE_NAME:this.buildGeoOrthographic(o,n,r,a,e);break;case TREE_CHART_TYPE_NAME:this.buildTree(o,n,r,a,e);break;case PACK_LAYOUT_CHART_TYPE_NAME:this.buildPackLayout(o,n,r,a,e);break;case CHOROPLETH_CHART_TYPE_NAME:this.buildChoropleth(o,n,r,a,e);break;case FORCE_CHART_TYPE_NAME:this.buildForce(o,n,r,a,e)}},Ng6O2ChartComponent.prototype.buildHistogram=function(t,a,e,r,n){console.log("in buildHistogram-------------------");var i=e.data,o=e.bins.length-1,l=e.range[1],s=new O2Common(t,a,l,300,r,n),d=s.graphWidth,g=s.graphHeight,c=s.graphInitXPos,p=s.graphInitYPos,u=a.title.display,h=a.animation.enable,f=a.animation.duration,_=a.grid.y.display,m=(a.margin.left,a.margin.top,a.className.histogramBar),y=new Array;for(var C in i)if(i.hasOwnProperty(C)){var v=i[C]/l;y.push(v)}var A=d3.format(",.0f"),b=t.append("g").attr("transform","translate("+c+","+p+")"),P=d3.scaleLinear().rangeRound([0,d]),x=d3.histogram().domain([0,1]).thresholds(P.ticks(o))(y),T=d3.scaleLinear().domain([0,d3.max(x,function(t){return t.length})]).range([g,0]),O=b.selectAll(".bar").data(x).enter().append("g").attr("class",m).attr("transform",function(t){return"translate("+P(t.x0)+","+T(t.length)+")"});h?O.append("rect").attr("x",1).attr("width",P(x[0].x1)-P(x[0].x0)-1).attr("height",0).transition().duration(f).attr("height",function(t){return g-T(t.length)}):O.append("rect").attr("x",1).attr("width",P(x[0].x1)-P(x[0].x0)-1).attr("height",function(t){return g-T(t.length)}),O.append("text").attr("dy",".75em").attr("y",6).attr("x",(P(x[0].x1)-P(x[0].x0))/2).attr("text-anchor","middle").text(function(t){return A(t.length)}),u&&this.drawTitle(s),this.buildYAxis(s),this.buildXAxis(s),_&&this.drawYGrid(s)},Ng6O2ChartComponent.prototype.buildForce=function(t,a,e,r,n){console.log("In  buildFoce----------------");var i=new O2Common(t,a,100,100,r,n),o=i.defaultColorFunc,l=i.graphHeight,s=i.graphWidth,d=a.margin.left,g=a.margin.top,c=d3.forceSimulation().force("link",d3.forceLink().id(function(t){return t.id})).force("charge",d3.forceManyBody()).force("center",d3.forceCenter(s/2,l/2)),p=t.append("g").attr("transform","translate("+d+","+g+")"),u=p.append("g").attr("class","force-links").selectAll("line").data(e.links).enter().append("line").attr("stroke-width",function(t){return Math.sqrt(t.value)}),h=p.append("g").attr("class","nodes").selectAll("circle").data(e.nodes).enter().append("circle").attr("r",5).attr("fill",function(t){return o(t.group)}).call(d3.drag().on("start",function(t){d3.event.active||c.alphaTarget(.3).restart();t.fx=t.x,t.fy=t.y}).on("drag",function(t){t.fx=d3.event.x,t.fy=d3.event.y}).on("end",function(t){d3.event.active||c.alphaTarget(0);t.fx=null,t.fy=null}));h.append("title").text(function(t){return t.id}),c.nodes(e.nodes).on("tick",function(){u.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),h.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})}),c.force("link").links(e.links);var f=new Array;for(var _ in e.groups)if(e.groups.hasOwnProperty(_)){var m=e.groups[_].id;f.push(new O2LegendData(e.groups[_].name,o(m)))}this.buildLegend(i,f)},Ng6O2ChartComponent.prototype.buildChoropleth=function(svgContainer,configData,dataSetJson,svgWidth,svgHeight){console.log("in buildChoropleth -------------------");var _maxX=100,_maxY=100,cdt=new O2Common(svgContainer,configData,_maxX,_maxY,svgWidth,svgHeight),_graphCenterPos=cdt.graphCenterPos,_titleDisplay=configData.title.display,_legendDisplay=configData.legend.display,_focusColor=configData.color.focusColor,_scale=dataSetJson.map.scale,_targetName=dataSetJson.map.targetName,_keyDataName=dataSetJson.map.keyDataName,_keyName="data."+_keyDataName,_geoMapDataUrl=dataSetJson.map.baseGeoDataUrl,_startColor=dataSetJson.map.startColor,_endColor=dataSetJson.map.endColor,_colorNum=dataSetJson.map.colorNumber,_center=dataSetJson.map.center,_targetPropertyName=dataSetJson.map.targetPropertyName,_targetProperty="d."+_targetPropertyName,color=d3.interpolateHsl(_startColor,_endColor),_max=dataSetJson.data[0].value,_min=dataSetJson.data[0].value;for(var i in dataSetJson.data)dataSetJson.data.hasOwnProperty(i)&&(_max<dataSetJson.data[i].value&&(_max=dataSetJson.data[i].value),_min>dataSetJson.data[i].value&&(_min=dataSetJson.data[i].value));var _range=_max-_min,_step=_range/(_colorNum-1),_findColorById=function(t){for(var a in dataSetJson.data)if(dataSetJson.data.hasOwnProperty(a)&&t===dataSetJson.data[a].id){var e=dataSetJson.data[a].value,r=Math.ceil((e-_min)/_step);return color(r/_max)}},path=d3.geoPath().projection(d3.geoMercator().center(_center).scale(_scale).translate(_graphCenterPos));if(d3.json(_geoMapDataUrl,function(error,data){svgContainer.selectAll("path").data(eval(_keyName)).enter().append("path").attr("d",path).style("fill",function(d,i){var _cl=_findColorById(eval(_targetProperty));return _cl})}),_titleDisplay&&this.drawTitle(cdt),_legendDisplay){for(var _legendDataSet=new Array,i=0;i<_colorNum;i++){var _label=String(_min+i*_step)+" --";_legendDataSet.push(new O2LegendData(_label,color(i/_max)))}this.buildLegend(cdt,_legendDataSet)}},Ng6O2ChartComponent.prototype.buildPackLayout=function(t,a,e,r,n){console.log("in PackLayout------------------");a.className.packlayout;var i=a.className.packlayoutLabel,o=a.animation.enable,l=a.animation.duration,s=d3.scaleOrdinal(d3.schemeCategory10),d=d3.pack().size([r,n]),g=d3.hierarchy(e),c=t.selectAll("g").data(d(g).descendants()).enter().append("g").attr("transform",function(t,a){return"translate("+t.x+","+t.y+")"}),p=c.append("circle");o?p.attr("r",0).transition().duration(function(t,a){return t.depth*l+500}).attr("r",function(t){return t.r}).style("fill",function(t,a){return s(a)}):p.attr("r",function(t){return t.r}).style("fill",function(t,a){return s(a)});var u=c.append("text").attr("class",i).text(function(t,a){return 1===t.depth?t.data.name:null});o?u.style("opacity",0).transition().duration(l).style("opacity",1):u.style("opacity",1)},Ng6O2ChartComponent.prototype.buildTree=function(t,a,e,r,n){console.log("In  buildTree----------------");var i=new O2Common(t,a,100,100,r,n),o=i.graphHeight,l=i.graphWidth,s=(a.animation.enable,a.animation.duration,a.className.treemap,a.className.treemapLabel,a.margin.left),d=a.margin.top,g=d3.tree().size([l,o])(d3.hierarchy(e)),c=t.append("g").attr("transform","translate("+s+","+d+")"),p=(c.selectAll(".link").data(g.descendants().slice(1)).enter().append("path").attr("class","tree-node-link").attr("d",function(t){return"M"+t.x+","+t.y+"C"+t.x+","+(t.y+t.parent.y)/2+" "+t.parent.x+","+(t.y+t.parent.y)/2+" "+t.parent.x+","+t.parent.y}),c.selectAll(".node").data(g.descendants()).enter().append("g").attr("class",function(t){return"tree-node"+(t.children?"-internal":"-leaf")}).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}));p.append("circle").attr("r",10),p.append("text").attr("dy",".35em").attr("y",function(t){return t.children?-20:20}).style("text-anchor","middle").text(function(t){return t.data.name})},Ng6O2ChartComponent.prototype.buildGeoOrthographic=function(svgContainer,configData,dataSetJson,svgWidth,svgHeight){console.log("in buildGeoOrthographic -------------------");var _maxX=100,_maxY=100,cdt=new O2Common(svgContainer,configData,_maxX,_maxY,svgWidth,svgHeight),_graphCenterPos=cdt.graphCenterPos,_titleDisplay=configData.title.display,_legendDisplay=configData.legend.display,_focusColor=configData.color.focusColor,_geoMapDataUrl=dataSetJson.map.baseGeoDataUrl,_scale=dataSetJson.map.scale,_targetName=dataSetJson.map.targetName,_targetProperty="d."+dataSetJson.map.targetPropertyName,_keyDataName=dataSetJson.map.keyDataName,_keyName="data."+_keyDataName,_clipAngle=dataSetJson.map.clipAngle,_rotateH=dataSetJson.map.rotate.horizontal,_rotateV=dataSetJson.map.rotate.vertical,_oceanColor=dataSetJson.map.oceanColor,_antarcticaColor=dataSetJson.map.antarcticaColor,_animation=configData.animation.enable,_animationDuration=configData.animation.duration,_animationH=0,_findColorByName=function(t){for(var a in dataSetJson.data){if(dataSetJson.data.hasOwnProperty(a))if(t===dataSetJson.data[a].name)return dataSetJson.data[a].color}return null},targetPath=d3.geoOrthographic().translate(_graphCenterPos).clipAngle(_clipAngle).scale(_scale).rotate([_rotateH,_rotateV]),path=d3.geoPath().projection(targetPath);if(d3.json(_geoMapDataUrl,function(error,data){svgContainer.append("circle").attr("cx",_graphCenterPos[0]).attr("cy",_graphCenterPos[1]).attr("r",_scale).style("fill",_oceanColor);var earthPath=svgContainer.selectAll("path").data(eval(_keyName)).enter().append("path").attr("d",path).style("fill",function(d,i){var _targetArea=eval(_targetProperty);return null!==_findColorByName(_targetArea)?_findColorByName(_targetArea):"hsl("+i+",80%,60%)"});_animation&&d3.timer(function(){targetPath.rotate([_rotateH+_animationH,_rotateV]),_animationH+=2,earthPath.attr("d",path)})}),_titleDisplay&&this.drawTitle(cdt),_legendDisplay){var _legendDataSet=new Array;for(var i in dataSetJson.data)if(dataSetJson.data.hasOwnProperty(i)){var _name=dataSetJson.data[i].name,_color=dataSetJson.data[i].color;if("Antarctica"===_name)continue;_legendDataSet.push(new O2LegendData(dataSetJson.data[i].name,dataSetJson.data[i].color))}this.buildLegend(cdt,_legendDataSet)}},Ng6O2ChartComponent.prototype.buildGeoMap=function(svgContainer,configData,dataSetJson,svgWidth,svgHeight){console.log("in buildGeoMap -------------------");var _maxX=100,_maxY=100,cdt=new O2Common(svgContainer,configData,_maxX,_maxY,svgWidth,svgHeight),_graphCenterPos=cdt.graphCenterPos,_geoMapDataUrl=dataSetJson.map.baseGeoDataUrl,_scale=dataSetJson.map.scale,_keyDataName=dataSetJson.map.keyDataName,_keyName="data."+_keyDataName,_targetProperty="d."+dataSetJson.map.targetPropertyName,_antarcticaColor=dataSetJson.map.antarcticaColor,_legendDisplay=configData.legend.display,path=d3.geoPath().projection(d3.geoMercator().translate(_graphCenterPos).scale(_scale)),_findColorByName=function(t){for(var a in dataSetJson.data){if(dataSetJson.data.hasOwnProperty(a))if(t===dataSetJson.data[a].name)return dataSetJson.data[a].color}return null};if(d3.json(_geoMapDataUrl,function(error,data){svgContainer.selectAll("path").data(eval(_keyName)).enter().append("path").attr("d",path).style("fill",function(d,i){var _targetArea=eval(_targetProperty);return null!==_findColorByName(_targetArea)?_findColorByName(_targetArea):"hsl("+i+",80%,60%)"})}),_legendDisplay){var _legendDataSet=new Array;for(var i in dataSetJson.data)if(dataSetJson.data.hasOwnProperty(i)){var _name=dataSetJson.data[i].name,_color=dataSetJson.data[i].color;if("Antarctica"===_name)continue;_legendDataSet.push(new O2LegendData(dataSetJson.data[i].name,dataSetJson.data[i].color))}this.buildLegend(cdt,_legendDataSet)}},Ng6O2ChartComponent.prototype.buildStackBar=function(svgContainer,configData,dataSetJson,svgWidth,svgHeight){console.log("in buildStackBar-------------------");var _totalY=new Array;for(var i in dataSetJson.data)dataSetJson.data.hasOwnProperty(i)&&_totalY.push(0);for(var i in dataSetJson.data)if(dataSetJson.data.hasOwnProperty(i)){var k=0;for(var j in dataSetJson.data[i].value)dataSetJson.data[i].value.hasOwnProperty(j)&&(_totalY[k++]+=dataSetJson.data[i].value[j].y)}var _maxX=0,_maxY=0;_maxY=d3.max(_totalY),_maxX=100;var cdt=new O2Common(svgContainer,configData,_maxX,_maxY,svgWidth,svgHeight),_color=cdt.defaultColorFunc,_columnNum=dataSetJson.data.length,_barWidth=cdt.graphWidth/_columnNum-configData.margin.between,_columnWidth=cdt.graphWidth/_columnNum,_initPosX=cdt.graphInitXPos,_graphHeight=cdt.graphHeight,_maxYValue=cdt.maxYValue,_opacity=configData.color.opacity,_legendDisplay=configData.legend.display,_gridYDisplay=configData.grid.y.display,_gridXDisplay=configData.grid.x.display,_labelDisplay=configData.label.display,_animation=configData.animation.enable,_animationDuration=configData.animation.duration,_seriesDateName=dataSetJson.series[0],_keyArray=new Array;for(var i in dataSetJson.data)if(dataSetJson.data.hasOwnProperty(i)){var _key=dataSetJson.data[i].name,_value=dataSetJson.data[i].value[0].y;_keyArray.push(_key)}var _dateArray=new Array;for(var i in dataSetJson.data[0].value)if(dataSetJson.data[0].value.hasOwnProperty(i)){var _xValue=dataSetJson.data[0].value[i].x;_dateArray.push(_xValue)}var _hashArray=new Array;for(var i in _dateArray)if(_dateArray.hasOwnProperty(i)){var _hashNumber={};for(var j in _keyArray)if(_keyArray.hasOwnProperty(j)){var _key=_keyArray[j],_value=dataSetJson.data[j].value[i].y;_hashNumber[_key]=_value}_hashArray.push(_hashNumber)}var yScale=d3.scaleLinear().domain([0,_maxYValue]).range([0,_graphHeight]),stack=d3.stack(),_rect=svgContainer.selectAll("g").data(stack.keys(_keyArray)(_hashArray)).enter().append("g").attr("fill",function(t,a){return _color(a)}).attr("fill-opacity",_opacity).selectAll("rect").data(function(t,a){return t}).enter().append("rect");if(_animation?_rect.attr("x",function(t,a){return _initPosX+a*_columnWidth}).attr("height",0).attr("y",function(d,i){var nm="d.data."+_keyArray[i],_yValue=eval(nm);return svgHeight-configData.margin.bottom-yScale(d[1])}).attr("width",_barWidth).transition().duration(_animationDuration).attr("height",function(t,a){return yScale(t[1]-t[0])}):_rect.attr("x",function(t,a){return _initPosX+a*_columnWidth}).attr("y",function(d,i){var nm="d.data."+_keyArray[i],_yValue=eval(nm);return svgHeight-configData.margin.bottom-yScale(d[1])}).attr("width",_barWidth).attr("height",function(t,a){return yScale(t[1]-t[0])}),this.drawTitle(cdt),this.buildYAxis(cdt),this.drawXBaseLine(cdt),_labelDisplay){var _labelArray=new Array;for(var i in dataSetJson.data[0].value)dataSetJson.data[0].value.hasOwnProperty(i)&&_labelArray.push(dataSetJson.data[0].value[i].x);this.drawXAxisLabel(cdt,_labelArray,STACK_BAR_CHART_TYPE_NAME)}if(_legendDisplay){var _legendDataSet=new Array;for(var i in dataSetJson.data)dataSetJson.data.hasOwnProperty(i)&&_legendDataSet.push(new O2LegendData(dataSetJson.data[i].name,_color(i)));this.buildLegend(cdt,_legendDataSet)}_gridYDisplay&&this.drawYGrid(cdt)},Ng6O2ChartComponent.prototype.buildScatterPlot=function(t,e,a,r,n){console.log("In  buildScatterPlot----------------");var i=new Array,o=0,l=0;for(var s in a.data)if(a.data.hasOwnProperty(s))for(var d in a.data[s].value)if(a.data[s].value.hasOwnProperty(d)){o<a.data[s].value[d].x&&(o=a.data[s].value[d].x),l<a.data[s].value[d].y&&(l=a.data[s].value[d].y);var g=new O2ScatterPlotData(a.data[s].value[d].x,a.data[s].value[d].y,a.data[s].value[d].r);i.push(g)}var c=new O2Common(t,e,o,l,r,n),p=c.graphInitXPos,u=a.series.length,h=c.defaultColorFunc,f=e.color.opacity,_=e.grid.y.display,m=e.grid.x.display,y=e.title.display,C=e.legend.display;t.selectAll("circle").data(i).enter().append("circle").attr("cx",function(t,a){return p+t.x}).attr("cy",function(t,a){return n-e.margin.bottom-t.y}).attr("r",function(t,a){return t.r}).style("fill",function(t,a){return h(a%u)}).attr("fill-opacity",f);if(y&&this.drawTitle(c),C){var v=new Array;for(s=0;s<a.series.length;s++)v.push(new O2LegendData(a.series[s],h(s)));this.buildLegend(c,v)}this.buildYAxis(c),this.buildXAxis(c),_&&this.drawYGrid(c),m&&this.drawXGrid(c)},Ng6O2ChartComponent.prototype.drawXGrid=function(t){console.log("in buildXGrid-------------------");var a=t,e=a.configData,r=a.svgContainer,n=a.gridXStep,i=a.maxXValue,o=(a.graphYScale,a.graphXScale),l=(a.graphWidth,e.className.grid),s=(d3.scaleLinear().domain([0,i]).range([0,i*o]),d3.range(n*o,i*o,n*o));r.append("g").selectAll("line.x").data(s).enter().append("line").attr("class",l).attr("x1",function(t,a){return e.margin.left+t}).attr("y1",a.svgHeight-e.margin.bottom).attr("x2",function(t,a){return e.margin.left+t}).attr("y2",e.margin.top+e.title.height)},Ng6O2ChartComponent.prototype.buildXAxis=function(t){console.log("in buildXAxis-------------------");var a=t,e=(a.configData,a.svgContainer),r=a.maxXValue,n=a.graphXScale,i=d3.scaleLinear().domain([0,r]).range([0,r*n]);e.append("g").attr("class",a.axisClassName).attr("transform",a.axisXBorderTranslatePos).call(d3.axisBottom(i))},Ng6O2ChartComponent.prototype.buildPie=function(t,a,e,r,n){console.log("In  buildPie----------------");var i=new O2Common(t,a,100,100,r,n),o=i.defaultColorFunc,l=i.graphHeight,s=a.color.opacity,d=(a.title.height,a.margin.left,a.margin.top,a.margin.bottom,a.margin.between,i.innerRadiusPercent),g=i.graphCenterTranslatePos,c=a.className.pie,p=a.className.pieNum,u=a.className.pieInnerTitle,h=i.innerRadiusTitleTranslatePos,f=i.innerRadiusTitle,_=a.title.display,m=a.legend.display,y=(a.label.display,a.pie.value.display),C=a.pie.percent.display,v=(a.animation.enable,a.animation.duration,new Array);for(var A in e.data)if(e.data.hasOwnProperty(A)){var b=e.data[A].value;v.push(b)}var P=d3.sum(v),x=d3.pie(),T=d3.arc().innerRadius(l*d/100).outerRadius(l/2),O=t.selectAll("path").data(x(v)).enter().append("g").attr("transform",g);t.append("text").attr("class",u).attr("transform",h).text(function(){return y&&C?f+":"+P+" (100%)":C?"100%":y?f+":"+P:void 0});if(O.append("path").attr("class",c).style("fill",function(t,a){return o(a)}).attr("fill-opacity",s).attr("d",T),O.append("text").attr("class",p).attr("transform",function(t,a){return"translate("+T.centroid(t)+")"}).text(function(t,a){if(y&&C){var e=String(Math.ceil(t.value/P*100));return String(t.value)+" ("+e+"%)"}return C?(e=String(Math.ceil(t.value/P*100)))+"%":y?t.value:void 0}),_&&this.drawTitle(i),m){var N=new Array;for(var A in e.data)e.data.hasOwnProperty(A)&&N.push(new O2LegendData(e.data[A].name,o(A)));this.buildLegend(i,N)}},Ng6O2ChartComponent.prototype.buildBar=function(t,a,e,r,n){console.log("In  buildBar----------------");var i=new Array;for(var o in e.data)if(e.data.hasOwnProperty(o))for(var l in e.data[o].y)if(e.data[o].y.hasOwnProperty(l)){var s=e.data[o].y[l];i.push(s)}var d;d=d3.max(i);var g=new O2Common(t,a,100,d,r,n),c=a.className.barValue,p=g.defaultColorFunc,u=e.series.length,h=i.length,f=g.graphInitYPos,_=g.graphHeight,m=g.graphWidth,y=a.color.opacity,C=(a.title.height,a.title.display),v=a.margin.left,A=(a.margin.top,a.margin.bottom,a.margin.between),b=(a.legend.display,a.label.display),P=a.grid.y.display,x=a.animation.enable,T=a.animation.duration,O=(m-A*h/u)/h,N=m/h,D=g.graphYScale,E=d3.scaleLinear().domain([0,d]).range([d*D,0]),S=A,Y=t.selectAll("g").data(i).enter().append("g").attr("transform",function(t,a){return"translate("+((a%u==0?S:0)+N*a)+")"}).style("fill",function(t,a){return p(a%u)}).attr("fill-opacity",y),H=Y.append("rect");if(x?H.attr("x",v).attr("height",0).attr("y",function(t){return f}).attr("width",O-S).transition().duration(T).attr("y",function(t){return E(t)+f}).attr("height",function(t){return _-E(t)}):H.attr("x",v).attr("y",function(t){return E(t)+f}).attr("width",O-S).attr("height",function(t){return _-E(t)}),Y.append("text").attr("class",c).attr("x",v).attr("y",function(t){return E(t)+f}).text(function(t){return t}),this.buildYAxis(g),b){var w=new Array;for(var o in e.data)e.data.hasOwnProperty(o)&&w.push(e.data[o].x);this.drawXAxisLabel(g,w,BAR_CHART_TYPE_NAME)}this.drawXBaseLine(g);var R=new Array;for(var o in e.series)e.series.hasOwnProperty(o)&&R.push(new O2LegendData(e.series[o],p(o)));this.buildLegend(g,R),C&&this.drawTitle(g),P&&this.drawYGrid(g)},Ng6O2ChartComponent.prototype.buildLine=function(t,a,e,r,n){console.log("in buildTest-------------------");var i=new Array;for(var o in e.data)if(e.data.hasOwnProperty(o)){var l=0;for(var s in e.data[o].value)e.data[o].value.hasOwnProperty(s)&&l<e.data[o].value[s].y&&(l=e.data[o].value[s].y);i.push(l)}var d;d=d3.max(i);var g=new O2Common(t,a,100,d,r,n),c=g.defaultColorFunc,p=e.data[0].value.length,u=g.graphWidth/p;for(var o in console.log(u),a.grid.y.display&&this.drawYGrid(g),e.data)if(e.data.hasOwnProperty(o)){var h=new Array;for(var s in e.data[o].value)if(e.data[o].value.hasOwnProperty(s)){var f=new O2IdValueData(parseInt(s,10),e.data[o].value[s].y);h.push(f)}var _=parseInt(o,10);this.drawSingleLine(g,h,_)}this.drawTitle(g),this.buildYAxis(g),this.drawXBaseLine(g);var m=new Array;for(var o in e.data[0].value)e.data[0].value.hasOwnProperty(o)&&m.push(e.data[0].value[o].x);this.drawXAxisLabel(g,m,LINE_CHART_TYPE_NAME);var y=new Array;for(var o in e.data)e.data.hasOwnProperty(o)&&y.push(new O2LegendData(e.data[o].name,c(o)));this.buildLegend(g,y)},Ng6O2ChartComponent.prototype.drawSingleLine=function(t,a,e){console.log("in drawSingleLine-------------------"),console.log(a);var r=t,n=r.configData,i=r.svgContainer,o=(r.maxXValue,r.axisXLabelInitXPos,r.axisXLabelInitYPos,a.length),l=r.graphWidth/(o-1),s=(d3.scaleOrdinal(d3.schemeCategory10),n.className.multiLinePrefix+String(e)),d=n.margin.left,g=n.margin.bottom,c=r.graphYScale,p=d3.line().curve(d3.curveLinear).x(function(t){return d+t.id*l}).y(function(t){return r.svgHeight-g-t.value*c});i.append("path").attr("class",s).attr("d",p(a))},Ng6O2ChartComponent.prototype.buildLegend=function(t,a){console.log("in buildLegend-------------------");var e=t,r=e.configData,n=e.svgContainer,i=r.legend.rectWidth,o=r.legend.ySpacing,l=e.legendInitXPos,s=e.legendInitYPos,d=r.color.opacity,g=n.append("g").selectAll("g").data(a).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate("+l+", "+(a*(i+o)+s)+")"});g.append("rect").attr("width",i).attr("height",i).style("fill",function(t){return t.color}).style("stroke",function(t){return t.color}).attr("fill-opacity",d),g.append("text").attr("x",i+10).attr("y",i).text(function(t){return t.title})},Ng6O2ChartComponent.prototype.drawXAxisLabel=function(t,a,e){console.log("in drawXAxisLabel-------------------");var r=t,n=r.configData,i=r.svgContainer,o=r.axisXLabelInitXPos,l=r.axisXLabelInitYPos,s=a.length,d=r.graphWidth/s;e===LINE_CHART_TYPE_NAME&&(d=r.graphWidth/(s-1)),i.append("g").selectAll("g").data(a).enter().append("g").attr("class",n.axisXText).attr("transform",function(t,a){return"translate("+(o+d*a)+", "+l+")"}).append("text").attr("class",n.className.axisXText).text(function(t,a){return t})},Ng6O2ChartComponent.prototype.drawXBaseLine=function(t){console.log("in drawXBaseLine-------------------");var a=t;a.svgContainer.append("rect").attr("class",a.axisXBorderLineClassName).attr("width",a.axisXBorderWidth).attr("height",a.axisXBorderLineWidth).attr("transform",a.axisXBorderTranslatePos)},Ng6O2ChartComponent.prototype.buildYAxis=function(t){console.log("in buildYAxis-------------------");var a=t,e=a.svgContainer,r=a.maxYValue,n=a.graphYScale,i=d3.scaleLinear().domain([0,r]).range([r*n,0]);e.append("g").attr("class",a.axisClassName).attr("transform",a.axisTranslatePos).call(d3.axisLeft(i))},Ng6O2ChartComponent.prototype.drawTitle=function(t){console.log("in drawTitle-------------------");var a=t,e=a.configData,r=a.svgContainer,n=e.title.name,i=a.titleInitXPos,o=a.titleInitYPos,l=e.title.className;r.append("text").attr("class",l).attr("x",i).attr("y",o).text(n)},Ng6O2ChartComponent.prototype.drawYGrid=function(t){console.log("in buildYGrid-------------------");var e=t,r=e.configData,a=e.svgContainer,n=e.gridYStep,i=e.maxYValue,o=e.graphYScale,l=r.className.grid,s=d3.range(n*o,i*o,n*o);a.append("g").selectAll("line.y").data(s).enter().append("line").attr("class",l).attr("x1",r.margin.left).attr("y1",function(t,a){return e.svgHeight-r.margin.bottom-t}).attr("x2",r.margin.left+e.axisXBorderWidth).attr("y2",function(t,a){return e.svgHeight-r.margin.bottom-t})},Ng6O2ChartComponent.decorators=[{type:core.Component,args:[{selector:"lib-Ng6O2Chart",template:"",styles:[]}]}],Ng6O2ChartComponent.ctorParameters=function(){return[{type:core.ElementRef}]},Ng6O2ChartComponent.propDecorators={chartType:[{type:core.Input}],svgWidth:[{type:core.Input}],svgHeight:[{type:core.Input}],graphData:[{type:core.Input}],configData:[{type:core.Input}]},Ng6O2ChartComponent}(),Ng6O2ChartModule=function(){function t(){}return t.decorators=[{type:core.NgModule,args:[{imports:[],declarations:[Ng6O2ChartComponent],exports:[Ng6O2ChartComponent]}]}],t}();exports.LINE_CHART_TYPE_NAME=LINE_CHART_TYPE_NAME,exports.BAR_CHART_TYPE_NAME=BAR_CHART_TYPE_NAME,exports.PIE_CHART_TYPE_NAME=PIE_CHART_TYPE_NAME,exports.SCATTER_PLOT_CHART_TYPE_NAME=SCATTER_PLOT_CHART_TYPE_NAME,exports.HISTOGRAM_CHART_TYPE_NAME=HISTOGRAM_CHART_TYPE_NAME,exports.STACK_BAR_CHART_TYPE_NAME=STACK_BAR_CHART_TYPE_NAME,exports.GEO_MAP_CHART_TYPE_NAME=GEO_MAP_CHART_TYPE_NAME,exports.GEO_ORTHOGRAPHIC_CHART_TYPE_NAME=GEO_ORTHOGRAPHIC_CHART_TYPE_NAME,exports.TREE_MAP_CHART_TYPE_NAME=TREE_MAP_CHART_TYPE_NAME,exports.PACK_LAYOUT_CHART_TYPE_NAME=PACK_LAYOUT_CHART_TYPE_NAME,exports.CHOROPLETH_CHART_TYPE_NAME=CHOROPLETH_CHART_TYPE_NAME,exports.TREE_CHART_TYPE_NAME=TREE_CHART_TYPE_NAME,exports.SANKEY_CHART_TYPE_NAME=SANKEY_CHART_TYPE_NAME,exports.FORCE_CHART_TYPE_NAME=FORCE_CHART_TYPE_NAME,exports.Ng6O2ChartComponent=Ng6O2ChartComponent,exports.Ng6O2ChartModule=Ng6O2ChartModule,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=ng6-o2-chart.umd.min.js.map